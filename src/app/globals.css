@import "tailwindcss";

@theme {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-panel: var(--panel);
  --color-primary: var(--primary);
  --color-primary-hover: var(--primary-hover);
  --color-accent: var(--accent);
  --color-secondary: var(--secondary);
  --color-danger: var(--danger);
  --color-focus-ring: var(--focus-ring);
}

/* =====================================================
   COZY GEMS THEME — warm cream + vibrant teal/coral
   Inspired by Pokemon, Kirby, Tamagotchi
   ===================================================== */
:root {
  --background: #fff7ed;        /* warm orange-50 cream */
  --foreground: #1c1917;        /* stone-900 warm dark */
  --panel: #ffffff;
  --panel-border: rgba(13, 148, 136, 0.12);

  --primary: #0d9488;           /* teal-600 — clean, vibrant */
  --primary-hover: #0f766e;     /* teal-700 */
  --primary-shadow: #115e59;    /* teal-800 — 3D button shadow */
  --primary-light: #ccfbf1;     /* teal-100 */

  --accent: #f97316;            /* orange-500 — warm pop */
  --accent-hover: #ea580c;      /* orange-600 */
  --accent-shadow: #c2410c;     /* orange-700 — 3D button shadow */
  --accent-light: #ffedd5;      /* orange-100 */

  --secondary: #a855f7;         /* purple-500 — Kirby! */
  --secondary-hover: #9333ea;   /* purple-600 */
  --secondary-shadow: #7e22ce;  /* purple-700 */

  --danger: #ef4444;            /* red-500 */
  --danger-shadow: #b91c1c;     /* red-700 */
  --focus-ring: #5eead4;        /* teal-300 */
}

/* Zen Theme — calmer palette, same structural tokens */
[data-theme='zen'] {
  --background: #fdfbf7;
  --foreground: #4a4a4a;
  --panel: #ffffff;
  --panel-border: rgba(16, 185, 129, 0.12);
  --primary: #10b981;
  --primary-hover: #059669;
  --primary-shadow: #065f46;
  --primary-light: #d1fae5;
  --accent: #fbbf24;
  --accent-hover: #f59e0b;
  --accent-shadow: #b45309;
  --accent-light: #fef9c3;
  --secondary: #a855f7;
  --secondary-hover: #9333ea;
  --secondary-shadow: #7e22ce;
  --danger: #f87171;
  --danger-shadow: #dc2626;
  --focus-ring: #34d399;
}

body {
  background-color: var(--background);
  color: var(--foreground);
  /* Nunito loaded via next/font — fallback to system rounded fonts */
  font-family: var(--font-nunito), 'Nunito', ui-rounded, system-ui, sans-serif;
  transition: background-color 0.3s ease, color 0.3s ease;
  /* Prevent pull-to-refresh rubber band on iOS game feel */
  overscroll-behavior: none;
  /* Subtle depth: dot-grid pattern + soft radial gradient overlay */
  background-image:
    radial-gradient(circle at 1px 1px, rgba(13, 148, 136, 0.03) 1px, transparent 0),
    radial-gradient(ellipse at 30% 20%, rgba(13, 148, 136, 0.05) 0%, transparent 60%),
    radial-gradient(ellipse at 80% 80%, rgba(249, 115, 22, 0.05) 0%, transparent 60%);
  background-size: 24px 24px, 100% 100%, 100% 100%;
  background-attachment: fixed;
}

@layer utilities {
  /* Mobile nav safe-area padding — accounts for iOS home indicator */
  .pb-nav {
    padding-bottom: calc(5rem + env(safe-area-inset-bottom));
  }
  /* Nav bar itself uses this height */
  .h-nav {
    height: calc(5rem + env(safe-area-inset-bottom));
    padding-bottom: env(safe-area-inset-bottom);
  }

  /*
   * SUDOKU VIEWPORT-BUDGET LAYOUT
   * Guarantees grid + header + numpad + nav all fit in one viewport — NO scrolling.
   * Mobile: vertical stack. Desktop: side-by-side.
   *
   * Budget (mobile):
   *   100dvh - nav(80px+safe) - header(44px) - numpad(~100px) - gaps(~24px) - page-padding(~32px)
   *   = available height for the grid
   */
  .sudoku-layout {
    display: flex;
    flex-direction: column;
    /* Total available = viewport minus bottom nav */
    height: calc(100dvh - 5rem - env(safe-area-inset-bottom));
    overflow: hidden;
    gap: 6px;
    padding: 4px 8px;
    animation: fadeIn 0.4s ease-out;
  }

  @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

  .sudoku-header {
    flex-shrink: 0;
  }

  .sudoku-play-area {
    flex: 1;
    min-height: 0; /* critical — allows flex children to shrink */
    overflow: hidden;
  }

  .sudoku-grid-container {
    flex: 1;
    min-height: 0;
    min-width: 0;
    /* On mobile: grid is a square that fills available height */
    max-height: 100%;
    width: 100%;
  }

  .sudoku-controls {
    flex-shrink: 0;
  }

  /* Desktop: side-by-side layout already handled by lg: classes */
  @media (min-width: 1024px) {
    .sudoku-layout {
      /* Desktop has no bottom nav — sidebar is on the side */
      height: calc(100dvh - 1rem);
      padding: 8px 16px;
    }
    .sudoku-grid-container {
      flex: 1;
      max-width: none;
    }
  }
  /* Game-style label text with Pokemon-style black outline */
  .game-label {
    text-shadow:
      -1px -1px 0 #000,
       1px -1px 0 #000,
      -1px  1px 0 #000,
       1px  1px 0 #000;
  }
  /* 3D button bottom-shadow press effect */
  /* Viewport-fit page utility */
  .page-viewport {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .page-scroll {
    height: 100%;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .btn-3d-teal {
    box-shadow: 0 5px 0 var(--primary-shadow);
  }
  .btn-3d-teal:hover {
    box-shadow: 0 5px 0 var(--primary-shadow), 0 0 20px rgba(13, 148, 136, 0.3);
  }
  .btn-3d-teal:active {
    box-shadow: 0 2px 0 var(--primary-shadow);
    transform: translateY(3px);
  }
  .btn-3d-orange {
    box-shadow: 0 5px 0 var(--accent-shadow);
  }
  .btn-3d-orange:hover {
    box-shadow: 0 5px 0 var(--accent-shadow), 0 0 20px rgba(249, 115, 22, 0.3);
  }
  .btn-3d-orange:active {
    box-shadow: 0 2px 0 var(--accent-shadow);
    transform: translateY(3px);
  }
  .btn-3d-purple {
    box-shadow: 0 5px 0 var(--secondary-shadow);
  }
  .btn-3d-purple:hover {
    box-shadow: 0 5px 0 var(--secondary-shadow), 0 0 20px rgba(168, 85, 247, 0.3);
  }
  .btn-3d-purple:active {
    box-shadow: 0 2px 0 var(--secondary-shadow);
    transform: translateY(3px);
  }

  .animate-gem-thump {
    animation: gemThump 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
  }

  .animate-gem-glow {
    animation: gemGlowPulse 1.5s infinite alternate;
  }
}

@keyframes gemThump {
  0% {
    transform: scale(1.5);
    opacity: 0;
  }

  50% {
    transform: scale(0.9);
    opacity: 1;
  }

  100% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes gemGlowPulse {
  0% {
    filter: drop-shadow(0 0 4px rgba(255, 215, 0, 0.4)) brightness(1.05);
  }

  100% {
    filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.9)) brightness(1.4);
  }
}

@keyframes gemFlash {
  0% {
    filter: brightness(2) drop-shadow(0 0 15px rgba(255, 255, 255, 1));
    transform: scale(1.1);
  }

  100% {
    filter: brightness(1) drop-shadow(0 0 2px rgba(255, 255, 255, 0));
    transform: scale(1);
  }
}

@keyframes flyOut {
  0% {
    transform: translate(0, 0) scale(var(--scale)) rotate(0deg);
    opacity: 1;
  }

  100% {
    transform: translate(var(--dx), var(--dy)) scale(0) rotate(var(--spin));
    opacity: 0;
  }
}

@layer utilities {
  .animate-gem-flash {
    animation: gemFlash 1s ease-out forwards;
  }

  .particle-fly {
    animation-name: flyOut;
    animation-timing-function: cubic-bezier(0.25, 1, 0.5, 1);
    animation-fill-mode: forwards;
  }

  .animate-pet-shake {
    animation: petShake 0.6s ease-in-out;
  }

  .animate-pet-float {
    animation: petFloat 3s ease-in-out infinite;
  }

  .animate-pet-bounce {
    animation: petBounce 0.5s cubic-bezier(0.36, 0.07, 0.19, 0.97);
  }
}

@keyframes petShake {

  0%,
  100% {
    transform: translateX(0);
  }

  15% {
    transform: translateX(-8px) rotate(-3deg);
  }

  30% {
    transform: translateX(8px) rotate(3deg);
  }

  45% {
    transform: translateX(-6px) rotate(-2deg);
  }

  60% {
    transform: translateX(6px) rotate(2deg);
  }

  75% {
    transform: translateX(-3px) rotate(-1deg);
  }

  90% {
    transform: translateX(3px) rotate(1deg);
  }
}

@keyframes petFloat {

  0%,
  100% {
    transform: translateY(0);
  }

  50% {
    transform: translateY(-8px);
  }
}

@keyframes petBounce {
  0% {
    transform: scale(1) translateY(0);
  }

  30% {
    transform: scale(1.15, 0.85) translateY(4px);
  }

  50% {
    transform: scale(0.9, 1.1) translateY(-16px);
  }

  70% {
    transform: scale(1.05, 0.95) translateY(-4px);
  }

  100% {
    transform: scale(1) translateY(0);
  }
}